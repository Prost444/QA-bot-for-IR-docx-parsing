# QA-bot-for-IR-docx-parsing

This repository contains the solution for the NLP case from Rosneft &amp; MIREA AI hackathon. It provides a method for parsing docx files, extracting tables and lists for further processing and embedding them into a QA model.

Этот репозиторий предоставляет решение для обработки .docx документов, извлечения структурированных данных (например, таблиц и списков) и интеграции их в систему для ответа на вопросы с использованием современных NLP-моделей. Проект разработан для масштабируемой обработки документов и интеграции с трансформерными языковыми моделями.

---

### Основные возможности:

- Парсинг документов:

	Использует библиотеку docx для извлечения структурированных данных, таких как таблицы и списки.

	Обрабатывает и форматирует извлеченные данные в единый контекст для использования в NLP-задачах.

- Работа с эмбеддингами:

	Реализована поддержка многогпу-вычислений с использованием библиотеки sentence-transformers.

	Обеспечивает создание, сохранение и загрузку FAISS-векторных индексов для эффективного поиска по схожести.

- Ответы на вопросы:

	Интеграция с трансформерными языковыми моделями с использованием библиотек transformers и torch.

	Настраиваемая генерация ответов на основе предоставленного контекста, поддерживая лаконичные и релевантные ответы.

- Ключевые компоненты:

	_docx_to_lang.py_: Обрабатывает .docx файлы, извлекает их содержимое (таблицы, списки, контекст) и преобразует их в совместимый формат для использования с Langchain.
	
	_llm.py_: Класс для взаимодействия с трансформерными языковыми моделями, обеспечивающий генерацию ответов на основе контекста и вопросов.
	
	_multi_gpu_embeddings.py_: Добавляет поддержку многогпу-вычислений для генерации эмбеддингов предложений и управления FAISS-векторными индексами.

- Технологический стек:

	Используемые библиотеки: torch, transformers, sentence-transformers, docx, faiss, langchain.

	Проект оптимизирован для многогпу-сред с целью ускорения генерации эмбеддингов и работы моделей.

- Сценарии применения:

	Системы управления корпоративными документами.

	Автоматический ответ на вопросы из структурированных документов.

	Улучшенные системы поиска и извлечения данных из больших репозиториев .docx файлов.

---

### Установка и использование

1. Установите зависимости с помощью

```batch
pip install -r requirements.txt
```

2. Подготовьте .docx файлы и обработайте их с помощью модуля docx_to_lang.

```py
nlp = spacy.load('<model>')

vs = create_empty_faiss_index(embedding_model)

docx2faiss([
	'doc1.docx',
	'doc2.docx',
	'doc3.docx',
], vs, nlp)
```

3. Генерируйте эмбеддинги с поддержкой GPU и создавайте FAISS-индексы с помощью _multi_gpu_embeddings_.

Пример: скачать базу данных википедии [здесь](https://drive.google.com/drive/folders/1-Tf7lbhTVmndmB5xKGTTE5r3eWNF8mih?usp=sharing)

4. Загрузите языковую модель и задавайте вопросы через модуль llm для выполнения QA-задач.

```py
llm = LLM("t-tech/T-lite-it-1.0")

llm.answer(doc.page_content,"Твой интересный вопрос")
```
